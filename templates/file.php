<?php

function getFileLists($path){
  $panFileLists = MyXpanfilelist($path);
  // echo gettype($panFileLists), PHP_EOL;
  // json_decode 第二个参数 true是转换成数组，false是转换成对象
  $panFileLists=json_decode($panFileLists ,true);
  $myFileLists = array();
  $i = 0;
  foreach($panFileLists['list'] as $panFileList)
  {
    // 文件名
    $myFileLists[$i]['server_filename'] = $panFileList['server_filename'];
    // 文件大小
    $myFileLists[$i]['size'] = $panFileList['size'];
    // 文件修改时间
    $myFileLists[$i]['server_mtime'] = date("Y-m-d H:i:s", $panFileList['server_mtime']);
    // 路径
    $myFileLists[$i]['path'] = $panFileList['path'];
    // 是否是文件夹
    $myFileLists[$i]['isdir'] = $panFileList['isdir'];
    if($myFileLists[$i]['isdir'] == 1){
      $myFileLists[$i]['isdir'] = '文件夹';
      $myFileLists[$i]['icon'] = 'M64 896V448h896v448H64zM64 256V128h256l128 128h512v128H64V256z';
    }
    else{
      $myFileLists[$i]['category'] = $panFileList['category'];
      switch($myFileLists[$i]['category']){
        case 1:
          $myFileLists[$i]['category'] = '视频';
          $myFileLists[$i]['icon'] = 'M661.618 392.011c0 2.373-2.496 6.521-7.453 12.454-4.992 5.933-10.336 12.92-16.031 20.988-5.695 8.06-11.004 16.831-15.996 26.314s-7.453 19.204-7.453 29.162c0 9.967 2.461 19.564 7.453 28.811 4.992 9.255 10.301 17.666 15.996 25.251 5.695 7.594 11.039 13.878 16.031 18.861 4.957 4.966 7.453 8.174 7.453 9.598v74.689c0 8.06-2.953 17.191-8.895 27.387-5.906 10.195-13.254 19.793-22.043 28.811-8.754 9-18.492 16.488-29.18 22.395-10.652 5.941-20.742 8.895-30.234 8.895H217.735c-12.797 0-24.539-2.25-35.191-6.75-10.688-4.5-20.039-10.793-28.125-18.844-8.051-8.068-14.344-17.543-18.844-28.459-4.5-10.907-6.75-22.764-6.75-35.561V329.415c0-9.483 2.145-19.327 6.398-29.522 4.289-10.195 10.301-19.556 18.141-28.099 7.84-8.534 17.086-15.645 27.738-21.34 10.688-5.687 22.395-8.534 35.227-8.534H569.86c12.797 0 24.785 2.25 35.93 6.759 11.145 4.5 20.848 10.67 29.145 18.492 8.297 7.831 14.836 17.191 19.582 28.099s7.102 22.526 7.102 34.857v61.884h-0.001z m221.238-66.867v325.09c0 10.433-2.742 19.679-8.191 27.738-5.449 8.068-13.641 12.094-24.539 12.094-3.797 0-8.648-1.424-14.59-4.271a163.878 163.878 0 0 1-17.754-9.958c-5.941-3.788-11.531-7.585-16.734-11.382-5.203-3.788-9-6.873-11.391-9.237-6.152-5.221-15.539-14.238-28.09-27.035-12.586-12.806-25.242-27.272-38.074-43.392-12.797-16.128-24.047-32.722-33.785-49.799-9.703-17.068-14.555-32.722-14.555-46.951 0-14.221 5.203-30.463 15.645-48.718s22.992-36.158 37.688-53.71 30.129-33.794 46.23-48.727c16.137-14.941 29.637-26.209 40.57-33.785 4.254-2.848 10.055-6.284 17.402-10.318s13.887-6.047 19.582-6.047c12.797 0 21.094 3.56 24.891 10.67s5.695 15.891 5.695 26.314v1.424z m0 0';
          break;
        case 2:
          $myFileLists[$i]['category'] = '音频';
          $myFileLists[$i]['icon'] = 'M865.792 67.456l-424.96 118.336c-51.52 13.376-93.248 62.208-93.248 109.12v407.936s-30.784-18.88-99.392-10.048c-100.736 13.056-182.4 83.392-182.4 157.184s81.664 118.976 182.4 105.984c100.8-12.928 174.656-81.152 174.656-155.008V452.672c0-32.704 43.264-46.72 43.264-46.72l375.808-107.2s41.536-12.672 41.536 22.336v279.808s-38.336-20.032-106.88-12.416c-100.736 11.072-182.464 79.936-182.464 153.728s81.664 120.512 182.464 109.376c100.8-11.136 182.464-79.936 182.464-153.792V128.128c-0.064-46.848-41.792-73.984-93.248-60.672z';
          break;
        case 3:
          $myFileLists[$i]['category'] = '图片';
          $myFileLists[$i]['icon'] = 'M853.161077 892.549156 362.595248 892.549156l-209.432916-0.413416c-0.605797-0.001023-1.210571-0.031722-1.813299-0.092098-24.848944-2.484587-47.825238-14.060227-64.696488-32.594349-16.990976-18.665105-26.349111-42.85504-26.349111-68.112284L60.303434 264.62596c0-55.80805 45.403073-101.211123 101.211123-101.211123l691.645496 0c55.80805 0 101.2101 45.403073 101.2101 101.211123l0 225.51315c0 0.275269-0.00614 0.551562-0.01842 0.825808-0.021489 0.494257-1.971911 51.723012 15.481599 85.46244 4.716418 9.118682 1.14815 20.335141-7.970532 25.052582-9.116635 4.714372-20.335141 1.149173-25.052582-7.970532-21.300119-41.176818-19.844977-97.642854-19.618826-103.738689L917.191392 264.62596c0-35.307134-28.724205-64.031339-64.031339-64.031339L161.51558 200.594621c-35.307134 0-64.031339 28.724205-64.031339 64.031339l0 526.71105c0 32.755008 24.320918 59.957557 56.717769 63.61997l208.4311 0.412392 490.528989 0c35.307134 0 64.031339-28.725228 64.031339-64.032362l-0.382717-93.676519c-0.104377-1.749854-1.587148-19.548218-19.549242-42.499953-0.050142-0.063445-0.098237-0.125867-0.147356-0.190335L875.401614 626.481358 758.174726 471.362464c-0.415462-0.550539-38.995129-50.852178-86.271876-45.534056-38.335097 4.314259-75.954903 45.163619-108.789729 118.131491-17.615193 39.141462-34.650171 68.26885-52.082192 89.046059-17.607006 20.985964-35.679617 33.519418-55.251372 38.316677-43.422975 10.638291-81.049944-18.99461-120.886231-50.372248l-5.057179-3.980661c-46.555315-36.57808-68.750827-28.223808-158.330028 59.60247-7.330966 7.187703-19.101033 7.071046-26.288736-0.25992-7.187703-7.330966-7.071046-19.101033 0.25992-26.287713 46.658669-45.74588 77.544097-72.726372 107.085924-84.282568 33.357735-13.048177 64.274886-6.266727 100.242052 21.99392l5.092995 4.00829c33.9226 26.719548 63.219857 49.795103 89.028663 43.466977 25.618471-6.279007 53.30095-42.114167 82.279958-106.508779 39.139415-86.97591 85.837994-134.027529 138.79716-139.849118 68.454068-7.515161 117.823476 57.404408 119.891578 60.171428l117.122511 154.980747 21.599947 28.343535c26.276457 33.630958 27.333532 61.638849 27.367301 64.72514 0.001023 0.042979 0.001023 0.084934 0.001023 0.127913l0.38374 94.059236C954.371176 847.146083 908.969127 892.549156 853.161077 892.549156z" fill="#1296db" p-id="10475"></path><path d="M312.328401 446.967868c-42.324968 0-76.759221-34.434254-76.759221-76.759221s34.434254-76.759221 76.759221-76.759221 76.759221 34.434254 76.759221 76.759221S354.654392 446.967868 312.328401 446.967868zM312.328401 330.628186c-21.824051 0-39.579437 17.755386-39.579437 39.579437s17.755386 39.579437 39.579437 39.579437 39.579437-17.755386 39.579437-39.579437S334.153476 330.628186 312.328401 330.628186z';
          break;
        case 4:
          $myFileLists[$i]['category'] = '文档';
          $myFileLists[$i]['icon'] = 'M654.826667 117.333333l209.173333 209.173334V928h-704v-810.666667h494.826667zM586.666667 181.312h-362.666667V864h576v-469.333333h-213.333333V181.333333zM704 672v64H320v-64h384z m0-170.666667v64H320v-64h384z m-203.264-170.666666v64H320v-64h180.736z m276.928 0L650.666667 203.669333V330.666667h126.997333z';
          break;
        case 5:
          $myFileLists[$i]['category'] = '应用';
          $myFileLists[$i]['icon'] = 'M957.189131 261.518615c0-7.999805-4.299895-15.499622-11.299724-19.399526L522.999731 2.924929c-6.799834-3.899905-15.199629-3.899905-21.999462 0L78.110593 242.019091c-6.999829 3.999902-11.299724 11.399722-11.299724 19.399527s4.399893 15.499622 11.399722 19.399526l422.989673 235.994239c3.399917 1.899954 7.099827 2.799932 10.799736 2.799931s7.499817-0.899978 10.799736-2.799931l422.989673-235.994239c6.999829-3.899905 11.399722-11.299724 11.399722-19.299529zM512 471.913479L134.509216 261.31862 512 47.823832l377.490784 213.394791L512 471.913479zM455.601377 581.410805L77.210615 381.015698c-6.899832-3.599912-15.199629-3.399917-21.899465 0.599985-6.699836 3.999902-10.799736 11.299724-10.799737 19.099534v378.390762c0 7.899807 4.199897 15.199629 10.999732 19.199531l378.390762 222.594566c3.499915 1.999951 7.399819 3.099924 11.299724 3.099924 3.799907 0 7.599814-0.999976 11.099729-2.899929 6.899832-3.999902 11.199727-11.299724 11.199726-19.299529V601.010327c0-8.1998-4.599888-15.799614-11.899709-19.599522zM423.002173 962.801494L89.010327 766.406289V437.714314l333.991846 176.695686v348.391494zM968.68885 381.615683c-6.699836-3.999902-14.999634-4.299895-21.899465-0.599985L568.398623 581.410805c-7.299822 3.899905-11.799712 11.399722-11.799712 19.699519v400.690218c0 7.999805 4.299895 15.399624 11.199727 19.299529 3.399917 1.999951 7.199824 2.899929 11.099729 2.899929 3.899905 0 7.79981-0.999976 11.299724-3.099924l378.390762-222.594566c6.799834-3.999902 10.999731-11.299724 10.999731-19.199531V400.715217c-0.099998-7.79981-4.199897-14.999634-10.899734-19.099534zM934.989673 766.406289L600.997827 962.801494V614.41l333.991846-176.695686v328.691975z';
          break;
        case 7:
          $myFileLists[$i]['category'] = '种子';
          $myFileLists[$i]['icon'] = 'M950.12864 511.77472c0-22.6304-18.3296-40.96-40.96-40.96h-138.99776v-78.39744c0-22.6304-18.3296-40.96-40.96-40.96s-40.96 18.3296-40.96 40.96v78.39744H528.7936v-265.4208c0-69.38624-56.25856-125.6448-125.6448-125.6448h-195.52256c-69.38624 0-125.6448 56.25856-125.6448 125.6448v615.2192c0 69.38624 56.25856 125.6448 125.6448 125.6448h195.52256c69.38624 0 125.6448-56.25856 125.6448-125.6448v-117.16608c0-22.6304-18.3296-40.96-40.96-40.96s-40.96 18.3296-40.96 40.96v117.16608c0 24.14592-19.57888 43.7248-43.7248 43.7248h-195.52256c-24.14592 0-43.7248-19.57888-43.7248-43.7248v-267.8784h524.34944v267.85792c0 69.38624 56.25856 125.6448 125.6448 125.6448h95.29344c22.6304 0 40.96-18.3296 40.96-40.96s-18.3296-40.96-40.96-40.96H813.8752c-24.14592 0-43.7248-19.57888-43.7248-43.7248V552.73472h138.99776c22.65088 0 40.98048-18.3296 40.98048-40.96z m-786.2272-40.96v-265.4208c0-24.10496 19.61984-43.7248 43.7248-43.7248h195.52256c24.10496 0 43.7248 19.61984 43.7248 43.7248v265.4208H163.90144z';
          break;
        default:
          $myFileLists[$i]['category'] = '其他';
          $myFileLists[$i]['icon'] = 'M525.354 79.891c25.407 0 46.004 20.583 46.004 45.974v204.803c0 19.043 15.447 34.481 34.503 34.481h218.694c25.407 0 46.003 20.583 46.003 45.974v420.448c0 69.825-56.64 126.429-126.51 126.429H249.51C179.64 958 123 901.396 123 831.57V206.32c0-69.825 56.64-126.429 126.51-126.429h275.844zM492.05 751.116c-9.546 0-18.137 2.86-24.82 9.536-6.682 6.198-10.023 14.303-10.023 24.316 0 9.536 3.341 17.641 10.024 24.317 6.682 6.675 15.273 10.012 24.82 10.012 9.545 0 18.137-3.337 24.819-9.536 6.682-6.675 10.5-14.78 10.5-24.793s-3.34-18.118-10.023-24.316c-6.682-6.676-15.273-9.536-25.297-9.536z m8.592-310.327c-35.32 0-63.004 10.013-83.05 30.515-18.955 18.935-28.949 44.263-29.981 76.39a60.36 60.36 0 0 0-0.019 1.33c0 13.8 11.188 24.987 24.988 24.987 13.783 0 24.999-11.094 25.149-24.877 0.01-0.955 0.021-1.571 0.033-1.848 0.759-18.082 5.013-32.284 12.763-42.606 9.546-13.827 25.297-20.503 46.776-20.503 17.182 0 31.024 4.768 40.57 14.304 9.069 9.536 13.842 22.41 13.842 39.097 0 12.397-4.773 23.84-13.365 34.806l-8.114 9.06c-29.592 26.223-47.73 45.772-53.935 59.122-6.682 12.396-9.546 27.654-9.546 45.295v14.587c0 14.103 11.433 25.536 25.536 25.536 14.103 0 25.535-11.433 25.535-25.536v-14.587c0-11.443 2.387-21.932 7.637-31.468 4.296-8.582 10.978-17.165 20.047-24.793 22.433-19.549 35.797-31.946 40.093-37.19 11.932-15.258 18.137-34.806 18.137-58.17 0-28.607-9.546-51.493-28.638-68.18-19.092-17.165-43.911-25.27-74.458-25.27zM619.837 76.995a18.4 18.4 0 0 1 12.725 5.109l234.743 224.735c7.34 7.028 7.595 18.675 0.567 26.016a18.4 18.4 0 0 1-13.291 5.675H633.637c-17.783 0-32.2-14.416-32.2-32.2V95.395c0-10.162 8.238-18.4 18.4-18.4z';
        }
    }
    $i++;
  }
  return $myFileLists;
}
// 获取某个目录下的文件列表 参数是目录路径
function getCurDirLists($path){
  $curFileList=MyXpanfilelistall($path);
  $curFileList =json_decode($curFileList ,true);
  echo $curFileList['list'][0]['path'];
  echo $curFileList['list'][0]['path'];
}

?>

